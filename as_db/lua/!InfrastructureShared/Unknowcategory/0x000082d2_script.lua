-- Decompiled using luadec 2.2 rev: 895d923 for Lua 5.1 from https://github.com/viruscamp/luadec
-- Command line: db 092023\as_db\lua\!InfrastructureShared\Unknowcategory\0x000082d2_luac 

-- params : ...
-- function num : 0
local l_0_0 = {}
-- DECOMPILER ERROR at PC6: No list found for R0 , SetList fails

-- DECOMPILER ERROR at PC7: Overwrote pending register: R1 in 'AssignReg'

-- DECOMPILER ERROR at PC9: Overwrote pending register: R2 in 'AssignReg'

-- DECOMPILER ERROR at PC11: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC12: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC13: Overwrote pending register: R5 in 'AssignReg'

;
(("SOAP:https://unitedstates.cp.wd.microsoft.com/WdCpSrvc.asmx").LoadDBVar)(("REST:https://unitedstates.cp.wd.microsoft.com/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://unitedstates.cp.wd.microsoft.com/wdcp.svc/bond/submitReport", "XPLATBROKER:https://unitedstates.x.cp.wd.microsoft.com/api/report", "")
local l_0_1 = {}
-- DECOMPILER ERROR at PC27: No list found for R1 , SetList fails

-- DECOMPILER ERROR at PC28: Overwrote pending register: R2 in 'AssignReg'

-- DECOMPILER ERROR at PC30: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC32: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC33: Overwrote pending register: R5 in 'AssignReg'

-- DECOMPILER ERROR at PC34: Overwrote pending register: R6 in 'AssignReg'

;
(("SOAP:https://mdav.us.stg.endpoint.security.microsoft.com/mdav/WdCpSrvc.asmx").LoadDBVar)(("REST:https://mdav.us.stg.endpoint.security.microsoft.com/mdav/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://mdav.us.stg.endpoint.security.microsoft.com/mdav/wdcp.svc/bond/submitreport", "AGWURI:https://mdav.us.stg.endpoint.security.microsoft.com", "XPLATBROKER:https://mdav.us.stg.endpoint.security.microsoft.com/xplat/api/report")
local l_0_2 = {}
-- DECOMPILER ERROR at PC41: Overwrote pending register: R7 in 'AssignReg'

-- DECOMPILER ERROR at PC42: No list found for R2 , SetList fails

-- DECOMPILER ERROR at PC43: Overwrote pending register: R3 in 'AssignReg'

-- DECOMPILER ERROR at PC45: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC47: Overwrote pending register: R5 in 'AssignReg'

-- DECOMPILER ERROR at PC48: Overwrote pending register: R6 in 'AssignReg'

-- DECOMPILER ERROR at PC49: Overwrote pending register: R7 in 'AssignReg'

;
(("SOAP:https://wdcpppe.microsoft.com/WdCpSrvc.asmx").LoadDBVar)(("REST:https://wdcpppe.microsoft.com/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://wdcpppe.microsoft.com/wdcp.svc/bond/submitreport", "XPLATBROKER:https://unitedstates.x.cp.wd.microsoft.com/api/report", "DEFUPDATE:https://mdav.us.stg.endpoint.security.microsoft.com/packages")
local l_0_3 = {}
-- DECOMPILER ERROR at PC56: Overwrote pending register: R8 in 'AssignReg'

-- DECOMPILER ERROR at PC57: No list found for R3 , SetList fails

-- DECOMPILER ERROR at PC58: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC60: Overwrote pending register: R5 in 'AssignReg'

-- DECOMPILER ERROR at PC62: Overwrote pending register: R6 in 'AssignReg'

-- DECOMPILER ERROR at PC63: Overwrote pending register: R7 in 'AssignReg'

-- DECOMPILER ERROR at PC64: Overwrote pending register: R8 in 'AssignReg'

;
(("SOAP:https://europe.cp.wd.microsoft.com/WdCpSrvc.asmx").LoadDBVar)(("REST:https://europe.cp.wd.microsoft.com/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://europe.cp.wd.microsoft.com/wdcp.svc/bond/submitReport", "XPLATBROKER:https://europe.x.cp.wd.microsoft.com/api/report", "DEFUPDATEMAC:https://mdav.us.stg.endpoint.security.microsoft.com/packages/?ostype=mac")
local l_0_4 = {}
-- DECOMPILER ERROR at PC71: Overwrote pending register: R9 in 'AssignReg'

-- DECOMPILER ERROR at PC72: No list found for R4 , SetList fails

-- DECOMPILER ERROR at PC73: Overwrote pending register: R5 in 'AssignReg'

-- DECOMPILER ERROR at PC75: Overwrote pending register: R6 in 'AssignReg'

-- DECOMPILER ERROR at PC77: Overwrote pending register: R7 in 'AssignReg'

-- DECOMPILER ERROR at PC78: Overwrote pending register: R8 in 'AssignReg'

-- DECOMPILER ERROR at PC79: Overwrote pending register: R9 in 'AssignReg'

;
(("SOAP:https://australia.cp.wd.microsoft.com/WdCpSrvc.asmx").LoadDBVar)(("REST:https://australia.cp.wd.microsoft.com/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://australia.cp.wd.microsoft.com/wdcp.svc/bond/submitReport", "XPLATBROKER:https://australia.x.cp.wd.microsoft.com/api/report", "DEFUPDATELIN:https://mdav.us.stg.endpoint.security.microsoft.com/packages/?ostype=linux")
local l_0_5 = {}
-- DECOMPILER ERROR at PC86: Overwrote pending register: R10 in 'AssignReg'

-- DECOMPILER ERROR at PC87: No list found for R5 , SetList fails

-- DECOMPILER ERROR at PC88: Overwrote pending register: R6 in 'AssignReg'

-- DECOMPILER ERROR at PC90: Overwrote pending register: R7 in 'AssignReg'

-- DECOMPILER ERROR at PC92: Overwrote pending register: R8 in 'AssignReg'

-- DECOMPILER ERROR at PC93: Overwrote pending register: R9 in 'AssignReg'

-- DECOMPILER ERROR at PC94: Overwrote pending register: R10 in 'AssignReg'

;
(("SOAP:https://unitedkingdom.cp.wd.microsoft.com/WdCpSrvc.asmx").LoadDBVar)(("REST:https://unitedkingdom.cp.wd.microsoft.com/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://unitedkingdom.cp.wd.microsoft.com/wdcp.svc/bond/submitReport", "XPLATBROKER:https://unitedkingdom.x.cp.wd.microsoft.com/api/report", "ECSURI:https://mdav.us.stg.endpoint.security.microsoft.com/ecs")
local l_0_6 = {}
-- DECOMPILER ERROR at PC101: Overwrote pending register: R11 in 'AssignReg'

-- DECOMPILER ERROR at PC102: Overwrote pending register: R12 in 'AssignReg'

-- DECOMPILER ERROR at PC108: No list found for R6 , SetList fails

-- DECOMPILER ERROR at PC109: Overwrote pending register: R7 in 'AssignReg'

-- DECOMPILER ERROR at PC111: Overwrote pending register: R8 in 'AssignReg'

-- DECOMPILER ERROR at PC113: Overwrote pending register: R9 in 'AssignReg'

-- DECOMPILER ERROR at PC114: Overwrote pending register: R10 in 'AssignReg'

-- DECOMPILER ERROR at PC115: Overwrote pending register: R11 in 'AssignReg'

;
(("SOAP:https://mdav.us.endpoint.security.microsoft.com/mdav/WdCpSrvc.asmx").LoadDBVar)(("REST:https://mdav.us.endpoint.security.microsoft.com/mdav/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://mdav.us.endpoint.security.microsoft.com/mdav/wdcp.svc/bond/submitreport", "AGWURI:https://mdav.us.endpoint.security.microsoft.com", "XPLATTEST:{\"macTest\":[{\"api\":\"/packages/?ostype=mac\",\"method\":\"HEAD\",\"response\":200}],\"linuxTest\":[{\"api\":\"/packages/?ostype=linux\",\"method\":\"HEAD\",\"response\":200}],\"xplatTest\":[{\"api\":\"/xplat/api/report\",\"method\":\"GET\",\"response\":200,\"verifySsl\":{}},{\"api\":\"/mdav/test\",\"method\":\"GET\",\"response\":404},{\"uri\":\"https://nf.smartscreen.microsoft.com/api/network/mac\",\"method\":\"POST\",\"response\":400}]}")
local l_0_7 = {}
-- DECOMPILER ERROR at PC122: Overwrote pending register: R12 in 'AssignReg'

-- DECOMPILER ERROR at PC123: Overwrote pending register: R13 in 'AssignReg'

-- DECOMPILER ERROR at PC124: Overwrote pending register: R14 in 'AssignReg'

-- DECOMPILER ERROR at PC125: Overwrote pending register: R15 in 'AssignReg'

-- DECOMPILER ERROR at PC126: Overwrote pending register: R16 in 'AssignReg'

-- DECOMPILER ERROR at PC127: Overwrote pending register: R17 in 'AssignReg'

-- DECOMPILER ERROR at PC129: No list found for R7 , SetList fails

-- DECOMPILER ERROR at PC130: Overwrote pending register: R8 in 'AssignReg'

-- DECOMPILER ERROR at PC132: Overwrote pending register: R9 in 'AssignReg'

-- DECOMPILER ERROR at PC134: Overwrote pending register: R10 in 'AssignReg'

-- DECOMPILER ERROR at PC135: Overwrote pending register: R11 in 'AssignReg'

-- DECOMPILER ERROR at PC136: Overwrote pending register: R12 in 'AssignReg'

;
(("SOAP:https://mdav.eu.endpoint.security.microsoft.com/mdav/WdCpSrvc.asmx").LoadDBVar)(("REST:https://mdav.eu.endpoint.security.microsoft.com/mdav/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://mdav.eu.endpoint.security.microsoft.com/mdav/wdcp.svc/bond/submitreport", "AGWURI:https://mdav.eu.endpoint.security.microsoft.com", "")
local l_0_8 = {}
-- DECOMPILER ERROR at PC143: Overwrote pending register: R13 in 'AssignReg'

-- DECOMPILER ERROR at PC144: Overwrote pending register: R14 in 'AssignReg'

-- DECOMPILER ERROR at PC145: Overwrote pending register: R15 in 'AssignReg'

-- DECOMPILER ERROR at PC146: Overwrote pending register: R16 in 'AssignReg'

-- DECOMPILER ERROR at PC147: Overwrote pending register: R17 in 'AssignReg'

-- DECOMPILER ERROR at PC148: Overwrote pending register: R18 in 'AssignReg'

-- DECOMPILER ERROR at PC150: No list found for R8 , SetList fails

-- DECOMPILER ERROR at PC151: Overwrote pending register: R9 in 'AssignReg'

-- DECOMPILER ERROR at PC153: Overwrote pending register: R10 in 'AssignReg'

-- DECOMPILER ERROR at PC155: Overwrote pending register: R11 in 'AssignReg'

-- DECOMPILER ERROR at PC156: Overwrote pending register: R12 in 'AssignReg'

-- DECOMPILER ERROR at PC157: Overwrote pending register: R13 in 'AssignReg'

;
(("SOAP:https://mdav.uk.endpoint.security.microsoft.com/mdav/WdCpSrvc.asmx").LoadDBVar)(("REST:https://mdav.uk.endpoint.security.microsoft.com/mdav/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://mdav.uk.endpoint.security.microsoft.com/mdav/wdcp.svc/bond/submitreport", "AGWURI:https://mdav.uk.endpoint.security.microsoft.com", "DEFUPDATEMAC:https://mdav.us.endpoint.security.microsoft.com/packages/?ostype=mac")
local l_0_9 = {}
-- DECOMPILER ERROR at PC164: Overwrote pending register: R14 in 'AssignReg'

-- DECOMPILER ERROR at PC165: Overwrote pending register: R15 in 'AssignReg'

-- DECOMPILER ERROR at PC166: Overwrote pending register: R16 in 'AssignReg'

-- DECOMPILER ERROR at PC167: Overwrote pending register: R17 in 'AssignReg'

-- DECOMPILER ERROR at PC168: Overwrote pending register: R18 in 'AssignReg'

-- DECOMPILER ERROR at PC169: Overwrote pending register: R19 in 'AssignReg'

-- DECOMPILER ERROR at PC171: No list found for R9 , SetList fails

-- DECOMPILER ERROR at PC172: Overwrote pending register: R10 in 'AssignReg'

-- DECOMPILER ERROR at PC174: Overwrote pending register: R11 in 'AssignReg'

-- DECOMPILER ERROR at PC176: Overwrote pending register: R12 in 'AssignReg'

-- DECOMPILER ERROR at PC177: Overwrote pending register: R13 in 'AssignReg'

-- DECOMPILER ERROR at PC178: Overwrote pending register: R14 in 'AssignReg'

;
(("SOAP:https://mdav.au.endpoint.security.microsoft.com/mdav/WdCpSrvc.asmx").LoadDBVar)(("REST:https://mdav.au.endpoint.security.microsoft.com/mdav/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://mdav.au.endpoint.security.microsoft.com/mdav/wdcp.svc/bond/submitreport", "AGWURI:https://mdav.au.endpoint.security.microsoft.com", "DEFUPDATELIN:https://mdav.us.endpoint.security.microsoft.com/packages/?ostype=linux")
local l_0_10 = {}
-- DECOMPILER ERROR at PC185: Overwrote pending register: R15 in 'AssignReg'

-- DECOMPILER ERROR at PC186: No list found for R10 , SetList fails

local l_0_11 = false
-- DECOMPILER ERROR at PC188: Overwrote pending register: R12 in 'AssignReg'

-- DECOMPILER ERROR at PC195: Overwrote pending register: R13 in 'AssignReg'

if (("REST:https://unitedstates1.cp.wd.microsoft.us/wdcp.svc/submitReport").GetEngineBuild)() >= 16700 then
  local l_0_12 = (string.lower)((("BOND:https://unitedstates1.cp.wd.microsoft.us/wdcp.svc/bond/submitReport").GetOrgID)())
  if l_0_12 == "baf4c18d-0c51-4329-9062-65c312537885" or l_0_12 == "d6ba914f-6a8f-47f9-9843-23913bb1a5a9" then
    local l_0_13 = {}
    -- DECOMPILER ERROR at PC205: Overwrote pending register: R15 in 'AssignReg'

    -- DECOMPILER ERROR at PC206: Overwrote pending register: R16 in 'AssignReg'

    -- DECOMPILER ERROR at PC207: Overwrote pending register: R17 in 'AssignReg'

    -- DECOMPILER ERROR at PC208: Overwrote pending register: R18 in 'AssignReg'

    -- DECOMPILER ERROR at PC209: No list found for R13 , SetList fails

    -- DECOMPILER ERROR at PC210: Overwrote pending register: R14 in 'AssignReg'

    -- DECOMPILER ERROR at PC212: Overwrote pending register: R15 in 'AssignReg'

    -- DECOMPILER ERROR at PC214: Overwrote pending register: R16 in 'AssignReg'

    -- DECOMPILER ERROR at PC215: Overwrote pending register: R17 in 'AssignReg'

    -- DECOMPILER ERROR at PC216: Overwrote pending register: R18 in 'AssignReg'

    ;
    (("SOAP:https://unitedstates4.cp.wd.microsoft.us/WdCpSrvc.asmx").LoadDBVar)(("ECSURI:https://mdav.us.endpoint.security.microsoft.com/ecs").DBVAR_ARRAY_WIDESTRING, "XPLATTEST:{\"macTest\":[{\"api\":\"/packages/?ostype=mac\",\"method\":\"HEAD\",\"response\":200}],\"linuxTest\":[{\"api\":\"/packages/?ostype=linux\",\"method\":\"HEAD\",\"response\":200}],\"xplatTest\":[{\"api\":\"/storage/ussus1eastprod/\",\"method\":\"GET\",\"response\":400},{\"api\":\"/storage/ussus1westprod/\",\"method\":\"GET\",\"response\":400},{\"api\":\"/xplat/api/report\",\"method\":\"GET\",\"response\":200,\"verifySsl\":{}},{\"api\":\"/mdav/test\",\"method\":\"GET\",\"response\":404},{\"uri\":\"https://nf.smartscreen.microsoft.com/api/network/mac\",\"method\":\"POST\",\"response\":400},{\"uri\":\"https://unitedstates.smartscreen.microsoft.com//api/network/mac\",\"method\":\"POST\",\"response\":400},{\"uri\":\"https://unitedstates.smartscreen-prod.microsoft.com//api/network/mac\",\"method\":\"POST\",\"response\":400}]}", "", "")
  end
end
do
  if l_0_11 == false then
    (database.LoadDBVar)(database.DBVAR_ARRAY_WIDESTRING, "MAPSURL_FFL4", l_0_10, 1)
  end
  local l_0_14 = {}
  -- DECOMPILER ERROR at PC235: No list found for R12 , SetList fails

  -- DECOMPILER ERROR at PC236: Overwrote pending register: R13 in 'AssignReg'

  -- DECOMPILER ERROR at PC238: Overwrote pending register: R14 in 'AssignReg'

  -- DECOMPILER ERROR at PC240: Overwrote pending register: R15 in 'AssignReg'

  -- DECOMPILER ERROR at PC241: Overwrote pending register: R16 in 'AssignReg'

  -- DECOMPILER ERROR at PC242: Overwrote pending register: R17 in 'AssignReg'

  ;
  (("SOAP:https://unitedstates4.cp.wd.microsoft.us/WdCpSrvc.asmx").LoadDBVar)(("REST:https://unitedstates4.cp.wd.microsoft.us/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://unitedstates4.cp.wd.microsoft.us/wdcp.svc/bond/submitReport", "XPLATBROKER:https://unitedstates4.x.cp.wd.microsoft.us/api/report", "")
  do
    local l_0_15 = {}
    -- DECOMPILER ERROR at PC250: No list found for R13 , SetList fails

    -- DECOMPILER ERROR at PC251: Overwrote pending register: R14 in 'AssignReg'

    -- DECOMPILER ERROR at PC253: Overwrote pending register: R15 in 'AssignReg'

    -- DECOMPILER ERROR at PC255: Overwrote pending register: R16 in 'AssignReg'

    -- DECOMPILER ERROR at PC256: Overwrote pending register: R17 in 'AssignReg'

    -- DECOMPILER ERROR at PC257: Overwrote pending register: R18 in 'AssignReg'

    ;
    (("SOAP:https://unitedstates2.cp.wd.microsoft.us/WdCpSrvc.asmx").LoadDBVar)(("REST:https://unitedstates2.cp.wd.microsoft.us/wdcp.svc/submitReport").DBVAR_ARRAY_WIDESTRING, "BOND:https://unitedstates2.cp.wd.microsoft.us/wdcp.svc/bond/submitReport", "XPLATBROKER:https://unitedstates2.x.cp.wd.microsoft.us/api/report", "")
    -- WARNING: undefined locals caused missing assignments!
  end
end

