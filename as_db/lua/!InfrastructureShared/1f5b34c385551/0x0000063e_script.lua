-- Decompiled using luadec 2.2 rev: 895d923 for Lua 5.1 from https://github.com/viruscamp/luadec
-- Command line: db 092023\as_db\lua\!InfrastructureShared\1f5b34c385551\0x0000063e_luac 

-- params : ...
-- function num : 0
local l_0_0 = (bm.get_imagepath)()
local l_0_1 = ((bm.get_current_process_startup_info)())
local l_0_2 = nil
local l_0_3 = {}
local l_0_4 = {}
-- DECOMPILER ERROR at PC11: No list found for R4 , SetList fails

local l_0_5 = {}
-- DECOMPILER ERROR at PC13: Overwrote pending register: R6 in 'AssignReg'

-- DECOMPILER ERROR at PC15: No list found for R5 , SetList fails

-- DECOMPILER ERROR at PC16: No list found for R3 , SetList fails

-- DECOMPILER ERROR at PC22: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC28: Overwrote pending register: R4 in 'AssignReg'

-- DECOMPILER ERROR at PC29: Overwrote pending register: R5 in 'AssignReg'

-- DECOMPILER ERROR at PC31: Overwrote pending register: R7 in 'AssignReg'

if l_0_4 ~= nil and l_0_0 ~= nil and not l_0_4 then
  l_0_4 = l_0_4(l_0_5, l_0_3, "")
end
if l_0_4 then
  l_0_4 = mp
  l_0_4 = l_0_4.CLEAN
  return l_0_4
end
l_0_4 = this_sigattrlog
l_0_4 = l_0_4[1]
l_0_4 = l_0_4.matched
if l_0_4 then
  l_0_4 = this_sigattrlog
  l_0_4 = l_0_4[1]
  l_0_4 = l_0_4.utf8p1
  if l_0_4 ~= nil then
    l_0_4 = this_sigattrlog
    l_0_4 = l_0_4[1]
    l_0_2 = l_0_4.utf8p1
  else
    l_0_4 = this_sigattrlog
    l_0_4 = l_0_4[2]
    l_0_4 = l_0_4.matched
    if l_0_4 then
      l_0_4 = this_sigattrlog
      l_0_4 = l_0_4[2]
      l_0_4 = l_0_4.utf8p1
      if l_0_4 ~= nil then
        l_0_4 = this_sigattrlog
        l_0_4 = l_0_4[2]
        l_0_2 = l_0_4.utf8p1
      else
        l_0_4 = this_sigattrlog
        l_0_4 = l_0_4[3]
        l_0_4 = l_0_4.matched
        if l_0_4 then
          l_0_4 = this_sigattrlog
          l_0_4 = l_0_4[3]
          l_0_4 = l_0_4.utf8p1
          if l_0_4 ~= nil then
            l_0_4 = this_sigattrlog
            l_0_4 = l_0_4[3]
            l_0_2 = l_0_4.utf8p1
          else
            l_0_4 = this_sigattrlog
            l_0_4 = l_0_4[4]
            l_0_4 = l_0_4.matched
            if l_0_4 then
              l_0_4 = this_sigattrlog
              l_0_4 = l_0_4[4]
              l_0_4 = l_0_4.utf8p1
              if l_0_4 ~= nil then
                l_0_4 = this_sigattrlog
                l_0_4 = l_0_4[4]
                l_0_2 = l_0_4.utf8p1
              else
                l_0_4 = this_sigattrlog
                l_0_4 = l_0_4[5]
                l_0_4 = l_0_4.matched
                if l_0_4 then
                  l_0_4 = this_sigattrlog
                  l_0_4 = l_0_4[5]
                  l_0_4 = l_0_4.utf8p1
                  if l_0_4 ~= nil then
                    l_0_4 = this_sigattrlog
                    l_0_4 = l_0_4[5]
                    l_0_2 = l_0_4.utf8p1
                  else
                    l_0_4 = this_sigattrlog
                    l_0_4 = l_0_4[6]
                    l_0_4 = l_0_4.matched
                    if l_0_4 then
                      l_0_4 = this_sigattrlog
                      l_0_4 = l_0_4[6]
                      l_0_4 = l_0_4.utf8p1
                      if l_0_4 ~= nil then
                        l_0_4 = this_sigattrlog
                        l_0_4 = l_0_4[6]
                        l_0_2 = l_0_4.utf8p1
                      else
                        l_0_4 = this_sigattrlog
                        l_0_4 = l_0_4[7]
                        l_0_4 = l_0_4.matched
                        if l_0_4 then
                          l_0_4 = this_sigattrlog
                          l_0_4 = l_0_4[7]
                          l_0_4 = l_0_4.utf8p1
                          if l_0_4 ~= nil then
                            l_0_4 = this_sigattrlog
                            l_0_4 = l_0_4[7]
                            l_0_2 = l_0_4.utf8p1
                          else
                            l_0_4 = this_sigattrlog
                            l_0_4 = l_0_4[8]
                            l_0_4 = l_0_4.matched
                            if l_0_4 then
                              l_0_4 = this_sigattrlog
                              l_0_4 = l_0_4[8]
                              l_0_4 = l_0_4.utf8p1
                              if l_0_4 ~= nil then
                                l_0_4 = this_sigattrlog
                                l_0_4 = l_0_4[8]
                                l_0_2 = l_0_4.utf8p1
                              else
                                l_0_4 = this_sigattrlog
                                l_0_4 = l_0_4[9]
                                l_0_4 = l_0_4.matched
                                if l_0_4 then
                                  l_0_4 = this_sigattrlog
                                  l_0_4 = l_0_4[9]
                                  l_0_4 = l_0_4.utf8p1
                                  if l_0_4 ~= nil then
                                    l_0_4 = this_sigattrlog
                                    l_0_4 = l_0_4[9]
                                    l_0_2 = l_0_4.utf8p1
                                  else
                                    l_0_4 = this_sigattrlog
                                    l_0_4 = l_0_4[10]
                                    l_0_4 = l_0_4.matched
                                    if l_0_4 then
                                      l_0_4 = this_sigattrlog
                                      l_0_4 = l_0_4[10]
                                      l_0_4 = l_0_4.utf8p1
                                      if l_0_4 ~= nil then
                                        l_0_4 = this_sigattrlog
                                        l_0_4 = l_0_4[10]
                                        l_0_2 = l_0_4.utf8p1
                                      else
                                        l_0_4 = this_sigattrlog
                                        l_0_4 = l_0_4[11]
                                        l_0_4 = l_0_4.matched
                                        if l_0_4 then
                                          l_0_4 = this_sigattrlog
                                          l_0_4 = l_0_4[11]
                                          l_0_4 = l_0_4.utf8p1
                                          if l_0_4 ~= nil then
                                            l_0_4 = this_sigattrlog
                                            l_0_4 = l_0_4[11]
                                            l_0_2 = l_0_4.utf8p1
                                          else
                                            l_0_4 = this_sigattrlog
                                            l_0_4 = l_0_4[12]
                                            l_0_4 = l_0_4.matched
                                            if l_0_4 then
                                              l_0_4 = this_sigattrlog
                                              l_0_4 = l_0_4[12]
                                              l_0_4 = l_0_4.utf8p1
                                              if l_0_4 ~= nil then
                                                l_0_4 = this_sigattrlog
                                                l_0_4 = l_0_4[12]
                                                l_0_2 = l_0_4.utf8p1
                                              end
                                            end
                                          end
                                          if l_0_2 == nil then
                                            l_0_4 = mp
                                            l_0_4 = l_0_4.CLEAN
                                            return l_0_4
                                          end
                                          l_0_4 = isTainted
                                          -- DECOMPILER ERROR at PC211: Overwrote pending register: R5 in 'AssignReg'

                                          l_0_4 = l_0_4(l_0_5, "remote_file_created_taint")
                                          if l_0_4 then
                                            l_0_4 = addRelatedProcess
                                            l_0_4()
                                            l_0_4 = reportRelatedBmHits
                                            l_0_4()
                                            l_0_4 = bm
                                            l_0_4 = l_0_4.add_related_file
                                            -- DECOMPILER ERROR at PC222: Overwrote pending register: R5 in 'AssignReg'

                                            l_0_4(l_0_5)
                                            l_0_4 = TrackPidAndTechniqueBM
                                            -- DECOMPILER ERROR at PC225: Overwrote pending register: R5 in 'AssignReg'

                                            l_0_4(l_0_5, "T1036", "DefenseEvasion_Masquerading_FileDropinBinByRemoteFile")
                                            l_0_4 = mp
                                            l_0_4 = l_0_4.INFECTED
                                            return l_0_4
                                          end
                                          l_0_4 = mp
                                          l_0_4 = l_0_4.CLEAN
                                          return l_0_4
                                        end
                                      end
                                    end
                                  end
                                end
                              end
                            end
                          end
                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  end
end

