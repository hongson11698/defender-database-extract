-- Decompiled using luadec 2.2 rev: 895d923 for Lua 5.1 from https://github.com/viruscamp/luadec
-- Command line: db 092023\av_db\lua\_!BatTamperA\ObMpAttributes\0x000000c9_luac 

-- params : ...
-- function num : 0
local l_0_0 = {}
l_0_0["AGGR:PowerShell/DisableAntiSpyware"] = 2
l_0_0["AGGR:PowerShell/DisableRealTimeMonitoring"] = 2
l_0_0["AGGR:PowerShell/DisableControlledFolderAccess"] = 1
l_0_0["AGGR:PowerShell/DisableRemovableDriveScanning"] = 1
l_0_0["AGGR:PowerShell/DisableScanningMappedNetworkDrives"] = 1
l_0_0["AGGR:PowerShell/DisableScanningNetworkFiles"] = 1
l_0_0["AGGR:PowerShell/DisablePuaProtection"] = 1
l_0_0["AGGR:PowerShell/DisableBehaviorMonitoring"] = 2
l_0_0["AGGR:PowerShell/DisableBLockAtFirstSeen"] = 2
l_0_0["AGGR:PowerShell/DisableIOAVProtection"] = 2
l_0_0["AGGR:PowerShell/DisablePrivacyMode"] = 1
l_0_0["AGGR:PowerShell/SignatureDisableUpdateOnStartupWithoutEngine"] = 1
l_0_0["AGGR:PowerShell/DisableArchiveScanning"] = 1
l_0_0["AGGR:PowerShell/DisableIntrusionPreventionSystem"] = 2
l_0_0["AGGR:PowerShell/DisableScriptScanning"] = 2
l_0_0["AGGR:PowerShell/SubmitSamplesConsent"] = 1
l_0_0["AGGR:PowerShell/MAPSReporting"] = 1
l_0_0["AGGR:PowerShell/HighThreatDefaultAction"] = 1
l_0_0["AGGR:PowerShell/ModerateThreatDefaultAction"] = 1
l_0_0["AGGR:PowerShell/LowThreatDefaultAction"] = 1
l_0_0["AGGR:PowerShell/SevereThreatDefaultAction"] = 1
l_0_0["AGGR:PowerShell/ScanScheduleDay"] = 1
l_0_0["AGGR:PowerShell/ExclusionPath"] = 1
l_0_0["AGGR:PowerShell/ExclusionProcess"] = 1
l_0_0["AGGR:PowerShell/BcdeditRecoverEnabledNo"] = 1
l_0_0["AGGR:PowerShell/BcdeditIgnoreAllFailures"] = 1
l_0_0["SCPT:PowerShell/WMIStopSQL"] = 1
l_0_0["SCPT:PowerShell/WMIStopExchange"] = 1
l_0_0["SCPT:PowerShell/WMIStopVeems"] = 1
l_0_0["SCPT:PowerShell/WMIStopMalwarebytes"] = 1
l_0_0["SCPT:PowerShell/WMIStopCarbonBlack1"] = 1
l_0_0["SCPT:PowerShell/WMIStopCarbonBlack2"] = 1
l_0_0["SCPT:PowerShell/ScStopCarbonBlack1"] = 1
l_0_0["SCPT:PowerShell/ScStopCarbonBlack2"] = 1
l_0_0["SCPT:PowerShell/SymantecEndpointStop1"] = 1
l_0_0["SCPT:PowerShell/SymantecEndpointStop2"] = 1
l_0_0["SCPT:PowerShell/Sophos"] = 1
l_0_0["SCPT:PowerShell/Sophos1"] = 1
l_0_0["SCPT:PowerShell/Sophos2"] = 1
l_0_0["SCPT:PowerShell/Sophos3"] = 1
l_0_0["SCPT:PowerShell/Sophos4"] = 1
l_0_0["SCPT:PowerShell/Sophos5"] = 1
l_0_0["SCPT:PowerShell/Sophos6"] = 1
l_0_0["SCPT:PowerShell/Sophos7"] = 1
l_0_0["SCPT:PowerShell/Sophos8"] = 1
l_0_0["SCPT:PowerShell/Sophos9"] = 1
l_0_0["SCPT:PowerShell/Sophos10"] = 1
l_0_0["AGGR:PowerShell/Mpcmdrun"] = 2
l_0_0["!#SCPT:DisableBootRecovery"] = 2
l_0_0["AGGR:PowerShell/PSBatExclusion"] = 2
l_0_0["AGGR:PowerShell/PSExeExclusion"] = 2
l_0_0["SCPT:PowerShell/WMIuninstallSecurityCenter"] = 2
l_0_0["SCPT:PowerShell/SmartScreenTakeown"] = 2
l_0_0["SCPT:PowerShell/SmartScreenIcacls1"] = 2
l_0_0["SCPT:PowerShell/SmartScreenTaskkill"] = 2
l_0_0["SCPT:PowerShell/SmartScreenIcacls2"] = 2
l_0_0["AGGR:PowerShell/UninstallWindowsFeature"] = 4
l_0_0["!#SCPT:DeleteDefenderSvc"] = 4
l_0_0["!#SCPT:UninstallMom"] = 4
l_0_0["SCPT:PowerShell/EnableIntrusionPreventionSystem"] = -2
l_0_0["SCPT:PowerShell/EnableIOAVProtection"] = -1
l_0_0["SCPT:PowerShell/EnableRealTimeMonitoring"] = -2
l_0_0["SCPT:PowerShell/EnableScriptScanninge"] = -1
l_0_0["SCPT:PowerShell/EnableControlledFolderAccess"] = -1
l_0_0["SCPT:PowerShell/EnableSubmitSamplesConsent"] = -1
l_0_0["SCPT:PowerShell/EnableMAPSReporting"] = -1
l_0_0["AGGR:PowerShell/TrendMacroExclusion"] = -1
l_0_0["AGGR:PowerShell/TrendMacroExclusion1"] = -1
l_0_0["SCPT:PowerShell/Installer"] = -100
l_0_0["AGGR:PowerShell/ExcludeGameCheat"] = -100
l_0_0["SCPT:PowerShell/FlareInstallationScript"] = -100
l_0_0["AGGR:PowerShell/XMLSysmon"] = -100
l_0_0["AGGR:PowerShell/PureSoftware"] = -100
l_0_0["AGGR:PowerShell/McafeeENSDefender"] = -100
l_0_0["AGGR:PowerShell/InstallMcAfeeAgent"] = -100
local l_0_1 = {}
l_0_1.yml = true
l_0_1.xml = true
l_0_1.json = true
l_0_1.txt = true
l_0_1.settings = true
l_0_1.tmp = true
l_0_1.log = true
l_0_1.pp = true
l_0_1.md = true
l_0_1.csv = true
l_0_1.yaml = true
l_0_1.sql = true
local l_0_2 = 0
local l_0_3 = (mp.getfilename)((mp.bitor)(mp.FILEPATH_QUERY_FNAME, mp.FILEPATH_QUERY_LOWERCASE))
local l_0_4 = (string.match)(l_0_3, "([^\\%.]+)$")
if l_0_4 == nil or #l_0_4 < 2 or l_0_1[l_0_4] == true then
  l_0_2 = l_0_2 - 100
end
for l_0_8,l_0_9 in pairs(l_0_0) do
  if (mp.get_mpattribute)(l_0_8) then
    l_0_2 = l_0_2 + l_0_9
  end
end
if l_0_2 >= 8 then
  return mp.INFECTED
end
if l_0_2 < 8 and l_0_2 >= 5 then
  return mp.LOWFI
end
return mp.CLEAN

